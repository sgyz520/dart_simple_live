name: app-build-action
#æ¨é€Tagæ—¶è§¦å‘
on:
    push:
        tags:
            - "dev_tv_v*"
jobs:
    build-tv:
        runs-on: macos-latest
        permissions:
            contents: write
        steps:
            #ç­¾å‡ºä»£ç 
            - uses: actions/checkout@v4
              with:
                  ref: master

            # è®¾ç½®JAVAç¯å¢ƒ
            - uses: actions/setup-java@v4
              with:
                  distribution: "zulu"
                  java-version: "17"
                  cache: "gradle"

            #è®¾ç½®Flutter
            - name: Flutter action
              uses: subosito/flutter-action@v2
              with:
                  flutter-version: "3.38.x"
                  cache: true

            #æ›´æ–°Flutterçš„packages
            - name: Restore packages
              run: |
                  cd simple_live_tv_app
                  flutter pub get

            #æ‰“åŒ…APKï¼ˆæœªç­¾åï¼‰
            - name: Build APK
              run: |
                  cd simple_live_tv_app
                  flutter build apk --release --split-per-abi --no-signing

            #ä¸Šä¼ APKè‡³Artifacts
            - name: Upload APK to Artifacts
              uses: actions/upload-artifact@v4
              with:
                  name: android_tv
                  path: |
                      simple_live_tv_app/build/app/outputs/flutter-apk/app-armeabi-v7a-release.apk
                      simple_live_tv_app/build/app/outputs/flutter-apk/app-arm64-v8a-release.apk
                      simple_live_tv_app/build/app/outputs/flutter-apk/app-x86_64-release.apk
            #å®Œæˆ
            - run: echo "ğŸ This job's status is ${{ job.status }}."
